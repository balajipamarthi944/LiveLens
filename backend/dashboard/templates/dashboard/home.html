<!DOCTYPE html>
<html>
<head>
    <title>LiveLens Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h1>LiveLens Dashboard</h1>

<h3>Real-Time Analytics</h3>

<ul>
    <li>Total Products: <b id="products">{{ product_count }}</b></li>
    <li>Total Offers: <b id="offers">{{ offer_count }}</b></li>
    <li>Total Messages: <b id="messages">{{ message_count }}</b></li>
</ul>

<hr>

<h3>Products vs Offers</h3>
<canvas id="barChart" width="400" height="200"></canvas>

<h3>Offers Status</h3>
<canvas id="pieChart" width="400" height="200"></canvas>

<script>
    const barCtx = document.getElementById('barChart');
    new Chart(barCtx, {
        type: 'bar',
        data: {
            labels: ['Products', 'Offers'],
            datasets: [{
                label: 'Count',
                data: [{{ product_count }}, {{ offer_count }}],
            }]
        }
    });

    const pieCtx = document.getElementById('pieChart');
    new Chart(pieCtx, {
        type: 'pie',
        data: {
            labels: ['Active Offers', 'Inactive Offers'],
            datasets: [{
                data: [{{ active_offers }}, {{ inactive_offers }}],
            }]
        }
    });
function loadStats(){
    fetch('/dashboard/api/stats/').then(response => response.json()).then(data =>{
        document.getElementById('products').innerText = data.products;
        document.getElementById('offers').innerText = data.offers;
        document.getElementById('messages').innerText = data.messages;
    })
    .catch(error => console.error('Error:',error));
}
loadStats()
setInterval(loadStats,5000);
</script>

</body>
</html>